[[extend 'layout.html']]

<style>
    [v-cloak] {
        display: none;
    }
</style>

<div class="section" id="vue-target" v-cloak>

    <div class="container block">
        <h1 class="title">Job Manager</h1>
		<details role="list">
			<summary aria-haspopup="listbox">Jobs</summary>
			<ul role="listbox" v-if="visible">
				<li v-for="r in rows"><a @click="load_job(r)">{{r.company}} - {{r.title}} - {{r.date_applied}}
					<button style="width: 10%;" @click="delete_job(r._idx)" class="secondary">
                        <a class="fa fa-trash"></a>
					</button></a>
				</li>
				<li @click="add_job(true)"><a>New</a></li>
			</ul>
		</details>
		<div v-for="j in active_job">
			<div v-for="tag in job_tags">

				<b>{{tag.name}}:</b><input type="text" class="input" v-model="j[tag.id]"
                               :class="{'is-focused': j._state[tag.id] === 'edit',
                          'is-static': j._state[tag.id] === 'clean'}"
                               :readonly="j._state[tag.id] === 'clean'"
                               @click="start_edit(j._idx, tag.id)"
                               @blur="stop_edit(j._idx, tag.id)" />
			</div>
			<label for="search">

			</label>

			<input @input="search_fields" v-model='inputField' id="search" type="text" placeholder="Search field">
			<div v-for="f in showing_fields">
				<button @click="autofill_click($event, f)">{{f.field}}</button>
			</div>
		</div>
    </div>

</div>


[[block page_scripts]]
<!-- Loads the index-specific js for Vue -->
<script>
    let load_jobs_url = "[[=XML(load_jobs_url)]]";
    let add_job_url = "[[=XML(add_job_url)]]";
    let delete_job_url = "[[=XML(delete_job_url)]]";
    let edit_job_url = "[[=XML(edit_job_url)]]";
</script>
<script src="js/index.js"></script>
[[end]]
