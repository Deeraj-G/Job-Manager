[[extend 'layout.html']]

<style>
    [v-cloak] {
        display: none;
    }
</style>

<div class="section" id="vue-target" v-cloak>

    <div class="container block">
		<!-- Title -->
        <h1 class="title">
			<div style="text-align: center">
				Job Manager
			</div>
		</h1>

		<!-- Stats portion to filter by Industry Field -->
		<label for="search">
			<input @input="search_fields" v-model='inputField' id="search" type="text" placeholder="Search field">
			<div v-for="f in showing_fields">
				<button class="secondary" @click="autofill_click($event, f)">{{f.field}}</button>
			</div>
		</label>

		<!-- Listing of User's Jobs -->
		<details role="list">
			<summary aria-haspopup="listbox">My Jobs</summary>
			<ul role="listbox" v-if="visible">
				<li class="grid" v-for="r in rows">
					<!-- Job Listing in Dropdown -->
					<a class="level-item" @click="load_job(r)">
						{{r.company}} - {{r.title}} - {{r.date_applied}}
					</a>
					<!-- Delete Button -->
					<div style="text-align: right">
						<a class="button" @click="delete_job(r._idx)" aria-label="delete">
							<span class="icon is-small">
								<i class="fa fa-trash" aria-hidden="true"></i>
							</span>
						</a>
					</div>
				</li>
				<!-- Add New Job -->
				<li @click="add_job(true)">
					<a class="button">
						<span class="icon">
							<i class="fa fa-plus"></i>
						</span>
					</a>
				</li>
			</ul>
		</details>
		<!-- Job Info Input Area -->
		<div v-for="j in active_job">

			<div v-for="tag in job_tags">
				<b>{{tag.name}}:</b>

				<!-- Dropdown for the Status field -->
				<div v-if="tag.id == 'status'">
					<input type="text" class="input" v-model="j[tag.id]"
						:class="{'is-focused': j._state[tag.id] === 'edit', 'is-static': j._state[tag.id] === 'clean'}"
						:readonly="j._state[tag.id] === 'clean'"
						@click="start_edit(j._idx, tag.id); search_fields_status(j._idx)"
						@blur="stop_edit(j._idx, tag.id)"
						@input="search_fields_status(j._idx)"
					/>
					<!-- <button class="secondary outline text-start"
						@click="start_edit(j._idx, tag.id); search_fields_status(j._idx);" 
						@input="stop_edit(j._idx, tag.id)"
						
					>{{rows[j._idx].status}}</button> -->
					<div v-for="s in showing_status_item">
						<button class="secondary" @click="autofill_click_status(j._idx, s); start_edit(j._idx, tag.id)" @blur="stop_edit(j._idx, tag.id)">{{s.status}}</button>
					</div>
				</div>

				<div v-else-if="tag.id == 'field'">
					<!-- Dropdown for the Field field -->
					<input type="text" class="input" v-model="j[tag.id]"
						:class="{'is-focused': j._state[tag.id] === 'edit', 'is-static': j._state[tag.id] === 'clean'}"
						:readonly="j._state[tag.id] === 'clean'"
						@click="start_edit(j._idx, tag.id)"
						@blur="stop_edit(j._idx, tag.id)"
						@input="search_fields_field(j._idx)"
					/>
					<div v-for="f in showing_fields_item">
						<button class="secondary" @click="autofill_click_field(j._idx, f); start_edit(j._idx, tag.id)" @blur="stop_edit(j._idx, tag.id)">{{f.field}}</button>
					</div>
				</div>

				<!-- Input boxes for the other fields -->
				<input v-else type="text" class="input" v-model="j[tag.id]"
					:class="{'is-focused': j._state[tag.id] === 'edit', 'is-static': j._state[tag.id] === 'clean'}"
						:readonly="j._state[tag.id] === 'clean'"
						@click="start_edit(j._idx, tag.id)"
						@blur="stop_edit(j._idx, tag.id)"
					/>
			</div>
		</div>
    </div>
</div>


[[block page_scripts]]
<!-- Loads the index-specific js for Vue -->
<script>
    let load_jobs_url = "[[=XML(load_jobs_url)]]";
    let add_job_url = "[[=XML(add_job_url)]]";
    let delete_job_url = "[[=XML(delete_job_url)]]";
    let edit_job_url = "[[=XML(edit_job_url)]]";
	let field_url = "[[=XML(field_url)]]";
</script>
<script src="js/index.js"></script>
[[end]]
